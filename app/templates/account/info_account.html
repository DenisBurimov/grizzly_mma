{% extends 'base.html' %}

{% block links %}
    <link href="{{ url_for('static', filename='css/custom_forms.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/user.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/qrscanner.css') }}" rel="stylesheet" media="screen">
{% endblock %}

{% block content %}
<main class="account_info_container">
  <form class="form-add account_info d-flex flex-column justify-content-between" action="{{ url_for('accounts.account_info', account_id=account.id) }}" method="post">

    <h1 class="h3 my-3">Account Info</h1>
    <p class="text-muted mb-5">Created by <b>{{account.user.username}}</b> at {{account.created_at.strftime('%Y-%m-%d, %H:%M')}}</p>

    <div class="hit-fieldset d-flex justify-content-between pb-2 w-100">
      <label class="fs-6 mt-2 w-25">Login: </label>
      <input id="login_input" class="form-control w-50" type="text" value="{{account.login}}">
      <div id="copy_login" class="btn btn-lg btn-primary ms-3 mb-5 copy_button"><span data-feather="copy"></span></div>
    </div>

    <div class="hit-fieldset d-flex justify-content-between pb-2 w-100">
      <label class="fs-6 mt-2 w-25">Password: </label>
      <input id="password_input" class="form-control w-50" type="text" value="{{account.password}}">
      <div id="copy_password" class="btn btn-lg btn-primary ms-3 mb-5 copy_button"><span data-feather="copy"></span></div>
    </div>

  </form>
  <!-- {{account.public_key}} -->

  <!-- QR-Scanner -->

  {% if not account.public_key %}
  <div class="my-5">
    <h6 class="my-3">Scan a QR-code with user's public_key:</h6>
    <div id="video-container" class="my-2">
        <video id="qr-video"></video>
    </div>

    <div class="scanner_options invisible">
        <label>
            Highlight Style
            <select id="scan-region-highlight-style-select">
                <option value="default-style">Default style</option>
                <option value="example-style-1">Example custom style 1</option>
                <option value="example-style-2">Example custom style 2</option>
            </select>
        </label>
        <label class="invisible">
            <input id="show-scan-region" type="checkbox">
            Show scan region canvas
        </label>
    </div>

    <div class="scanner_options invisible">
        <select id="inversion-mode-select">
            <option value="original">Scan original (dark QR code on bright background)</option>
            <option value="invert">Scan with inverted colors (bright QR code on dark background)</option>
            <option value="both">Scan both</option>
        </select>
        <br>
    </div>

    <div class="scanner_options invisible">
        <b>Device has camera: </b>
            <span id="cam-has-camera"></span>
        <br>
    </div>

    <div class="scanner_options invisible">
        <b>Preferred camera:</b>
        <select id="cam-list">
            <option value="environment" selected>Environment Facing (default)</option>
            <option value="user">User Facing</option>
        </select>
    </div>

    <div class="invisible">
        <b>Camera has flash: </b>
        <span id="cam-has-flash"></span>
    </div>

    <div class="invisible">
        <button id="flash-toggle">ðŸ“¸ Flash: <span id="flash-state">off</span></button>
    </div>

    <div class="scanner_options invisible">
        <br>
        <b>Detected QR code: </b>
        <span id="cam-qr-result">None</span>
        <form action="{{ url_for('accounts.account_info', account_id=account.id) }}" method="post">

            <textarea id="qr_data" name="qr_data"></textarea>
            <input id="send_value" type="submit">
        </form>
    </div>

    <div class="invisible">
        <b>Last detected at: </b>
        <span id="cam-qr-result-timestamp"></span>
    </div>

    <div class="scanner_options d-flex justify-content-between invisible">
        <button id="start-button" class="qrscanner_button">Start</button>
        <button id="stop-button" class="qrscanner_button">Stop</button>
    </div>

    <div class="scanner_options d-flex flex-column invisible">
      <h1>Scan from File:</h1>
      <input type="file" id="file-selector">
      <p class="mt-3"><b>Detected QR code: </b> <span id="file-qr-result">None</span></p>
      <p>{{info}}</p>
    </div>

    <div class="d-flex justify-content-center">
        <p><a class="user_update" href="{{ url_for('accounts.accounts_page') }}">Go back</a></p>
      </div>
  </div>
  {% endif %}
</main>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/account_buttons.js') }}" type="text/javascript"></script>
  <script src="{{ url_for('static', filename='js/qrscanner.js') }}" type="module"></script>
{% endblock %}